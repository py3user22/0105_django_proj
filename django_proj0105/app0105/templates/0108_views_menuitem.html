<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>0108 views.py save for menuitems variables </title>
    <style>
        .def {color: orange;} .from {color: tan;} .apiv {color: purple;} .meni {color: green;}
        .miss {color: green;} .retu {color: red;} p {border: 2px blue dashed; padding: 5px;}


    </style>
</head>
<body>
    <h2>0108 pagination > to add page limits per API call to server </h2> <br>
    <h3>___#0108 views.py save </h3>
    <p>
        <a href="from" class="from">from</a> rest_framwork <a href="impo" class="impo">import</a> status <br>
        <a href="from" class="from">from</a> decimal <a href="impo" class="impo">import</a> Decimal <br>
        <a href="from" class="from">from</a> django.shortcuts <a href="impo" class="impo">import</a> get_object_or_404 <br>
        <a href="from" class="from">from</a> rest_framwork.response <a href="impo" class="impo">import</a> Response <br>
        <a href="from" class="from">from</a> rest_framwork.decorators <a href="impo" class="impo">import</a> api_view, renderer_classes <br>
        <a href="from" class="from">from</a> .models <a href="impo" class="impo">import</a> MenuItem <br>
        <a href="from" class="from">from</a> .serailizers <a href="impo" class="impo">import</a> MenuItemSerializer <br>
        <a href="from" class="from">from</a> django.core.paginator <a href="impo" class="impo">import</a> Paginator, EmptyPage <br>

        <br>
        <br>
        <a href="apiv" class="apiv">@api_view</a>(['GET','POST']) <br>
        <a href="def" class="def">def</a> <b><i>menu_items</i></b>(request): <br>
        <br>
        .. <a href="if" class="if">if</a> (request.method=='GET'): <br>
        ...... items = <a href="meni" class="meni">MenuItem</a>.objects.select_related('category').all()  <br>
        ...... category_name = request.query_params.get('category') <br>
        ...... to_price = request.query_params.get('to_price') <br>
        ...... search = request.query_params.get('search') <br>
        ...... ordering = request.query_params.get('ordering') <br>
        ...... perpage = request.query_params.get('perpage', default=2) <br>
        ...... page = request.query_params.get('page', default=1)<br>
        <br>
        <br>
        ...... <a href="if" class="if">if</a> category_name: <br>
        .......... items = items.filter(category__title=category_name) <br>
        ...... <a href="if" class="if">if</a> to_price: <br>
        .......... items = items.filter(price=to_price) <br>
        ...... <a href="if" class="if">if</a> search: <br>
        .......... items = items.filter(title__contains=search) <br>
        ...... <a href="if" class="if">if</a> ordering: <br>
        .......... ordering_fields = ordering.split(",") <br>
        .......... items = items.order_by(*ordering_fields) <br>
        <br>
        <br>
        ...... paginator = Paginator(items, per_page=perpage) <br>
        ...... <a href="try" class="try">try</a>: <br>
        .......... items = paginator.page(number=page) <br>
        ...... <a href="exce" class="exce">except</a> EmptyPage: <br>
        .......... items = [ ] <br>

        <br>
        <br>
        ...... serialized_item = <a href="miss" class="miss">MenuItemSerializer</a>(items, many=True) <br>
        ...... <a href="retu" class="retu">return</a> Response(serialized_item.data) <br>
        <br>
        <br>
        .. <a href="elif" class="elif">elif</a> request.method=='POST': <br>
        ...... serialized_item = <a href="miss" class="miss">MenuItemSerializer</a>(data=request.data)  <br>
        ...... serialized_item.is_valid(raise_exception=True)  <br>
        ...... serialized_item.save()  <br>
        ...... <a href="retu" class="retu">return</a> Response(serialized_item.validated_data, status.HTTP_201_CREATED) <br>
        <br>
        <br>





    </p>
    <br>
    <br>




</body>
</html>